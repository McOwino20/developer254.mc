<form id="feedbackForm" method="POST" action="https://formspree.io/f/mgegvboj">
    <textarea name="feedback" required></textarea>
    <input type="hidden" name="datetime_submitted" id="datetime_submitted">
    <hr>
    <input type="hidden" name="location" id="location">
    <hr>
    <input type="hidden" name="device_type" id="device_type">
    <hr>
    <input type="hidden" name="network_provider" id="network_provider">
    <hr>
    <input type="hidden" name="user_agent" id="user_agent">
    <hr>
    <input type="hidden" name="connection_type" id="connection_type">
    <hr>
    <input type="hidden" name="latitude" id="latitude">
    <hr>
    <input type="hidden" name="longitude" id="longitude">
    <hr>
    <input type="hidden" name="accuracy" id="accuracy">
    <button type="submit">Submit</button>
</form>

<script>
    // Capture Date and Time
    document.getElementById('datetime_submitted').value = new Date().toISOString();

    // Fetch Geolocation Data
    fetch('https://ipinfo.io/json?token=1a4beeb8578f3b')
    .then(response => response.json())
    .then(data => {
        document.getElementById('location').value = data.city + ', ' + data.region + ', ' + data.country;
        document.getElementById('network_provider').value = data.org;
    });

    // Detect Device Type
    let deviceType = "Unknown";
    if (navigator.userAgent.match(/mobile/i)) {
        deviceType = "Mobile";
    } else if (navigator.userAgent.match(/tablet/i)) {
        deviceType = "Tablet";
    } else {
        deviceType = "Desktop";
    }
    document.getElementById('device_type').value = deviceType;
    // Capture User Agent
    document.getElementById('user_agent').value = navigator.userAgent;
    // Capture Connection Type
    function getConnectionType() {
        let connectionType = "Unknown";

        if (navigator.connection) {
            const type = navigator.connection.effectiveType;
            
            if (type === "wifi") {
                connectionType = "WiFi";
            } else if (type === "cellular") {
                connectionType = "Cellular";
            } else if (type === "ethernet") {
                connectionType = "Ethernet";
            } else if (type === "none") {
                connectionType = "No connection";
            } else {
                connectionType = type.charAt(0).toUpperCase() + type.slice(1); // Capitalize first letter
            }
        } else {
            connectionType = "Not supported by this browser";
        }

        document.getElementById('connection_type').value = connectionType;
    }

    document.addEventListener("DOMContentLoaded", function() {
        getConnectionType();
        getLocation();
    });



   // Capture Location                        
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError, {
                enableHighAccuracy: true,
                timeout: 10000, // 10 seconds
                maximumAge: 0
            });
        } else {
            alert("Geolocation is not supported by this browser.");
        }
    }

    function showPosition(position) {
        document.getElementById('latitude').value = position.coords.latitude;
        document.getElementById('longitude').value = position.coords.longitude;
        document.getElementById('accuracy').value = position.coords.accuracy;

        // You can now use these coordinates for more precise location-based services
        fetchNearbyPlaces(position.coords.latitude, position.coords.longitude);
    }

    function showError(error) {
        switch (error.code) {
            case error.PERMISSION_DENIED:
                alert("User denied the request for Geolocation.");
                break;
            case error.POSITION_UNAVAILABLE:
                alert("Location information is unavailable.");
                break;
            case error.TIMEOUT:
                alert("The request to get user location timed out.");
                break;
            case error.UNKNOWN_ERROR:
                alert("An unknown error occurred.");
                break;
        }
    }







</script>
