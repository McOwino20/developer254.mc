<form id="feedbackForm" method="POST" action="https://formspree.io/f/mgegvboj">
    <textarea name="feedback" required></textarea>
    <input type="hidden" name="datetime_submitted" id="runningDate">
    <input type="hidden" name="location" id="location">
    <input type="hidden" name="device_type" id="device_type">
    <input type="hidden" name="network_provider" id="network_provider">
    <input type="hidden" name="user_agent" id="user_agent">
    <input type="hidden" name="connection_type" id="connection_type">

    <input type="hidden" name="latitude" id="latitude">
    <input type="hidden" name="longitude" id="longitude">
    <input type="hidden" name="accuracy" id="accuracy">
    <button type="submit">Submit</button>
</form>

<script>
    // Capture Date and Time
    
function captureTime() {
        const now = new Date();
        const utcDateTime = now.toISOString(); // Get the current date and time in UTC
        document.getElementById('datetime_submitted').value = utcDateTime;
}
  // Capture the time as soon as the form is submitted
    document.getElementById('feedbackForm').addEventListener('submit', function() {
        captureTime();
    });
    // Fetch Geolocation Data
    fetch('https://ipinfo.io/json?token=1a4beeb8578f3b')
    .then(response => response.json())
    .then(data => {
        document.getElementById('location').value = data.city + ', ' + data.region + ', ' + data.country;
        document.getElementById('network_provider').value = data.org;
    });

    // Detect Device Type
    let deviceType = "Unknown";
    if (navigator.userAgent.match(/mobile/i)) {
        deviceType = "Mobile";
    } else if (navigator.userAgent.match(/tablet/i)) {
        deviceType = "Tablet";
    } else {
        deviceType = "Desktop";
    }
    document.getElementById('device_type').value = deviceType;
    // Capture User Agent
    document.getElementById('user_agent').value = navigator.userAgent;
    // Capture Connection Type
    function getConnectionType() {
        let connectionType = "Unknown";

        if (navigator.connection) {
            const type = navigator.connection.effectiveType;
            
            if (type === "wifi") {
                connectionType = "WiFi";
            } else if (type === "cellular") {
                connectionType = "Cellular";
            } else if (type === "ethernet") {
                connectionType = "Ethernet";
            } else if (type === "none") {
                connectionType = "No connection";
            } else {
                connectionType = type.charAt(0).toUpperCase() + type.slice(1); // Capitalize first letter
            }
        } else {
            connectionType = "Not supported by this browser";
        }

        document.getElementById('connection_type').value = connectionType;
    }

    document.addEventListener("DOMContentLoaded", function() {
        getConnectionType();
        getLocation();
    });



   // Capture Location                        
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError, {
                enableHighAccuracy: true,
                timeout: 10000, // 10 seconds
                maximumAge: 0
            });
        } else {
            alert("Geolocation is not supported by this browser.");
        }
    }

    function showPosition(position) {
        document.getElementById('latitude').value = position.coords.latitude;
        document.getElementById('longitude').value = position.coords.longitude;
        document.getElementById('accuracy').value = position.coords.accuracy;

        // You can now use these coordinates for more precise location-based services
        fetchNearbyPlaces(position.coords.latitude, position.coords.longitude);
    }

    function showError(error) {
        switch (error.code) {
            case error.PERMISSION_DENIED:
                alert("User denied the request for Geolocation.");
                break;
            case error.POSITION_UNAVAILABLE:
                alert("Location information is unavailable.");
                break;
            case error.TIMEOUT:
                alert("The request to get user location timed out.");
                break;
            case error.UNKNOWN_ERROR:
                alert("An unknown error occurred.");
                break;
        }
    }








            

   // Function to update the date on the page
        function updateDate() {
            var currentDate = new Date();
            var day = currentDate.getDate();
            var month = currentDate.getMonth() + 1; // January is 0, so add 1
            var year = currentDate.getFullYear();
            var hours = currentDate.getHours();
            var minutes = currentDate.getMinutes();
            var seconds = currentDate.getSeconds();
            var ampm = hours >= 12 ? 'PM' : 'AM'; // Determine if it's AM or PM

            // Convert hours to 12-hour format
            hours = hours % 12;
            hours = hours ? hours : 12; // If hours is 0, set it to 12

            // Add leading zero to single-digit days, months, hours, minutes, and seconds
            day = (day < 10) ? '0' + day : day;
            month = (month < 10) ? '0' + month : month;
            hours = (hours < 10) ? '0' + hours : hours;
            minutes = (minutes < 10) ? '0' + minutes : minutes;
            seconds = (seconds < 10) ? '0' + seconds : seconds;

            // Display the date and time on the page
            document.getElementById('runningDate').innerHTML = day + '/' + month + '/' + year + ' ' + hours + ':' + minutes + ':' + seconds + ' ' + ampm;

            // Schedule the function to run again after 1 second (1000 milliseconds)
            setTimeout(updateDate, 1000);
        }

        // Start the date update function when the page loads
        window.onload = updateDate;
    </script>
  <!--end of time and date script-->
   

</script>
